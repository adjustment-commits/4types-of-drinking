<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ALTIé£²é…’ã‚¿ã‚¤ãƒ—è¨ºæ–­</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f2027">
<link rel="apple-touch-icon" href="icons-192.png">
<link rel="stylesheet" href="style.css">
</head>

<body>
<h1>ALTIé£²é…’ã‚¿ã‚¤ãƒ—è¨ºæ–­</h1>

<!-- ğŸ”¹ è³ªå•ãƒ•ã‚©ãƒ¼ãƒ  -->
<div id="quiz">
  <form id="altiForm">
    <div class="question"><p>1. ãŠé…’ã‚’é£²ã‚“ã§10åˆ†ä»¥å†…ã«é¡”ãŒèµ¤ããªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚</p>
      <label><input type="radio" name="q1" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q1" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>2. ãƒ“ãƒ¼ãƒ«1æ¯ã§ã‚‚å‹•æ‚¸ã‚„æ¯è‹¦ã—ã•ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚</p>
      <label><input type="radio" name="q2" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q2" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>3. å°‘é‡ã§ã‚‚ä½“ãŒç†±ããªã‚Šã€æ‰‹è¶³ãŒã»ã¦ã‚‹ã€‚</p>
      <label><input type="radio" name="q3" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q3" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>4. ç¿Œæœã€é ­ç—›ã‚„å€¦æ€ æ„ŸãŒæ®‹ã‚‹ã“ã¨ãŒå¤šã„ã€‚</p>
      <label><input type="radio" name="q4" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q4" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>5. ãŠé…’ã‚’é£²ã‚“ã å¤œã¯çœ ã‚ŠãŒæµ…ããªã‚Šã‚„ã™ã„ã€‚</p>
      <label><input type="radio" name="q5" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q5" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>6. ãŠé…’ã‚’é£²ã‚“ã ç¿Œæ—¥ã€é›†ä¸­åŠ›ãŒè½ã¡ã‚‹ã€‚</p>
      <label><input type="radio" name="q6" value="slow"> ã¯ã„</label>
      <label><input type="radio" name="q6" value="fast"> ã„ã„ãˆ</label></div>

    <div class="question"><p>7. å‘¨ã‚Šã®ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã«å¼•ã£å¼µã‚‰ã‚Œã‚„ã™ã„ã€‚</p>
      <label><input type="radio" name="q7" value="emo"> ã¯ã„</label>
      <label><input type="radio" name="q7" value="cool"> ã„ã„ãˆ</label></div>

    <div class="question"><p>8. æ–­ã‚‹ã‚ˆã‚Šã‚‚ã€Œå°‘ã—ã ã‘é£²ã‚‚ã†ã€ã¨æ€ã£ã¦ã—ã¾ã†ã€‚</p>
      <label><input type="radio" name="q8" value="emo"> ã¯ã„</label>
      <label><input type="radio" name="q8" value="cool"> ã„ã„ãˆ</label></div>

    <div class="question"><p>9. é£²ã¿ä¼šã§ã¯é™ã‹ã‚ˆã‚Šã‚‚ç››ã‚Šä¸ŠãŒã£ã¦ã„ãŸã„ã€‚</p>
      <label><input type="radio" name="q9" value="emo"> ã¯ã„</label>
      <label><input type="radio" name="q9" value="cool"> ã„ã„ãˆ</label></div>

    <div class="question"><p>10. ãŠé…’ã‚’é£²ã‚€ã¨æ°—åˆ†ãŒé«˜æšã—ã‚„ã™ã„ã€‚</p>
      <label><input type="radio" name="q10" value="emo"> ã¯ã„</label>
      <label><input type="radio" name="q10" value="cool"> ã„ã„ãˆ</label></div>

    <!-- ğŸ”¹ ä½“èª¿ã¨é£²ã¿ä¼šãƒ¢ãƒ¼ãƒ‰ -->
    <div class="option-group">
      <p>ğŸ”‹ ä½“èª¿ã‚’é¸æŠï¼š</p>
      <label><input type="radio" name="condition" value="1.2"> çµ¶å¥½èª¿</label>
      <label><input type="radio" name="condition" value="1.0" checked> æ™®é€š</label>
      <label><input type="radio" name="condition" value="0.8"> ç–²åŠ´æ°—å‘³</label>

      <p style="margin-top:10px;">ğŸ‰ é£²ã¿ä¼šãƒ¢ãƒ¼ãƒ‰ï¼š</p>
      <label><input type="checkbox" id="partyMode"> ONã«ã™ã‚‹</label>
    </div>

    <button type="button" onclick="showResult()">è¨ºæ–­ã™ã‚‹</button>
  </form>
</div>

<!-- ğŸ”¹ çµæœè¡¨ç¤º -->
<div class="result" id="result">
  <h2 id="typeName"></h2>
  <img id="typeImg" src="" alt="è¨ºæ–­çµæœç”»åƒ">

  <div class="result-box">
    <p class="desc" id="typeDesc"></p>
    <p id="doseResult" class="desc"></p>
  </div>

  <div id="intakeInput" class="fade-in">
    <h3>ğŸ¶ é£²ã‚€äºˆå®šã‚’å…¥åŠ›</h3>

    <div class="drinkRow"><span class="label">ğŸº ãƒ“ãƒ¼ãƒ«ï¼ˆ20g/æœ¬ï¼‰</span>
      <input type="number" id="beer" min="0" step="1" value="0"><span class="unit">æœ¬</span></div>
    <div class="drinkRow"><span class="label">ğŸ¹ é…ãƒã‚¤ï¼ˆ20g/ç¼¶ï¼‰</span>
      <input type="number" id="chu" min="0" step="1" value="0"><span class="unit">ç¼¶</span></div>
    <div class="drinkRow"><span class="label">ğŸ¥ƒ ãƒã‚¤ãƒœãƒ¼ãƒ«ï¼ˆ20g/æ¯ï¼‰</span>
      <input type="number" id="high" min="0" step="1" value="0"><span class="unit">æ¯</span></div>
    <div class="drinkRow"><span class="label">ğŸ¶ æ—¥æœ¬é…’ï¼ˆ22g/åˆï¼‰</span>
      <input type="number" id="sake" min="0" step="1" value="0"><span class="unit">åˆ</span></div>
    <div class="drinkRow"><span class="label">ğŸŸ¤ ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ï¼ˆ19g/æ¯ï¼‰</span>
      <input type="number" id="whisky" min="0" step="1" value="0"><span class="unit">æ¯</span></div>

    <button type="button" onclick="calcTotalIntake()">åˆè¨ˆã§åˆ¤å®šã™ã‚‹</button>
    <p id="intakeResult" class="desc"></p>
    <p id="advice" class="desc" style="font-style:italic;"></p>
  </div>

  <button id="toggleTypeCards" class="info-btn">ã‚¿ã‚¤ãƒ—åˆ¥ç‰¹å¾´ã‚’è¦‹ã‚‹</button>
  <button onclick="restart()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>

  <p class="desc" style="font-size:0.8em;color:#ccc;">
    â€» ã“ã®è¨ºæ–­ã¯ã‚ãã¾ã§ä¸€èˆ¬çš„ãªç›®å®‰ã§ã™ã€‚<br>
    å¥åº·çŠ¶æ…‹ã‚„å€‹äººå·®ã«ã‚ˆã‚Šå®‰å…¨é‡ã¯ç•°ãªã‚Šã¾ã™ã€‚<br>
    ç„¡ç†ã®ãªã„ç¯„å›²ã§ã€æ¥½ã—ãã‚¹ãƒãƒ¼ãƒˆã«é£²ã¿ã¾ã—ã‚‡ã†ã€‚
  </p>
</div>

  <!-- ğŸ”¹ ã‚¿ã‚¤ãƒ—åˆ¥ç‰¹å¾´ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="typeModal" class="modal">
  <div class="modal-content zoom-in">
    <button class="close-btn" id="closeTypeCards">Ã—</button>
    <h3>ğŸ§  ã‚¿ã‚¤ãƒ—åˆ¥ç‰¹å¾´</h3>

    <div class="type-card">
      <img src="image/slow-emo.png" alt="Slow-Emo" class="type-img">
      <h4>ğŸ”¥Slow-Emoï¼ˆæ„Ÿæƒ…ã‚¸ã‚§ãƒƒãƒˆå‹ï¼‰</h4>
      <ul>
        <li><b>SAFEï¼š</b>ç¬‘é¡”ã§ã‚°ãƒ©ã‚¹ã‚’æ²ã’ã‚‹</li>
        <li><b>WARNï¼š</b>é¡”ãŒèµ¤ãå°‘ã—ãƒ†ãƒ³ã‚·ãƒ§ãƒ³é«˜ã‚</li>
        <li><b>DANGERï¼š</b>é¡”çœŸã£èµ¤ï¼‹æ°·æ°´ã§å†·é™ã«ãªã‚ã†ã¨ã™ã‚‹</li>
      </ul>
    </div>

    <div class="type-card">
      <img src="image/fast-emo.png" alt="Fast-Emo" class="type-img">
      <h4>âš¡Fast-Emoï¼ˆç¤¾äº¤ã‚¿ãƒ¼ãƒœå‹ï¼‰</h4>
      <ul>
        <li><b>SAFEï¼š</b>ãƒãƒªã‚ˆãä¹¾æ¯</li>
        <li><b>WARNï¼š</b>å°‘ã—é…”ã„æ°—å‘³ã§ãƒ”ãƒ¼ã‚¹</li>
        <li><b>DANGERï¼š</b>ã‚°ãƒ©ã‚°ãƒ©ï¼‹å‹äººã«æ­¢ã‚ã‚‰ã‚Œã‚‹</li>
      </ul>
    </div>

    <div class="type-card">
      <img src="image/fast-cool.png" alt="Fast-Cool" class="type-img">
      <h4>â„ï¸Fast-Coolï¼ˆç†æ€§ã‚¹ãƒ—ãƒªãƒ³ãƒˆå‹ï¼‰</h4>
      <ul>
        <li><b>SAFEï¼š</b>ã‚¯ãƒ¼ãƒ«ã«è»½ãä¸€æ¯</li>
        <li><b>WARNï¼š</b>é¡”ãŒèµ¤ãç†æ€§ã‚’ä¿ã¤</li>
        <li><b>DANGERï¼š</b>æ‰‹ã§ã€Œä»Šæ—¥ã¯ã“ã“ã¾ã§ã€ã‚µã‚¤ãƒ³</li>
      </ul>
    </div>

    <div class="type-card">
      <img src="image/slow-cool.png" alt="Slow-Cool" class="type-img">
      <h4>ğŸŒ¿Slow-Coolï¼ˆæ…é‡ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å‹ï¼‰</h4>
      <ul>
        <li><b>SAFEï¼š</b>è½ã¡ç€ã„ã¦è«‡ç¬‘</li>
        <li><b>WARNï¼š</b>å°‘ã—çœ ãã†ã«ã‚†ã£ãŸã‚Š</li>
        <li><b>DANGERï¼š</b>ã‚¦ãƒˆã‚¦ãƒˆï¼‹ç¬‘é¡”</li>
      </ul>
    </div>
  </div>
</div>

<script>
// ==== ã‚¹ã‚³ã‚¢åˆ¤å®š ====
const alcoholTable = { beer:20, chu:20, high:20, sake:22, whisky:19 };

function showResult(){
  const answeredQ = document.querySelectorAll('input[name^="q"]:checked').length;
  if(answeredQ < 10){ alert("ã™ã¹ã¦ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„"); return; }

  let score = { slow:0, fast:0, emo:0, cool:0 };
  document.querySelectorAll('input[name^="q"]:checked').forEach(a => score[a.value]++);
  const axis1 = score.slow > score.fast ? "slow" : "fast";
  const axis2 = score.emo > score.cool ? "emo" : "cool";
  const type = axis1 + "-" + axis2;

  const baseDose = { "slow-emo":30, "fast-emo":40, "fast-cool":45, "slow-cool":35 };
  let grams = baseDose[type];
  const cond = parseFloat(document.querySelector('input[name="condition"]:checked').value);
  const party = document.getElementById("partyMode").checked ? 1.5 : 1.0;
  grams = Math.round(grams * cond * party);

  const info = {
    "slow-emo": {name:"ğŸ”¥Slow-Emoï¼ˆæ„Ÿæƒ…ã‚¸ã‚§ãƒƒãƒˆå‹ï¼‰", img:"image/slow-emo.png", desc:"æ„Ÿæƒ…ãŒç‡ƒãˆã‚„ã™ããƒšãƒ¼ã‚¹ã‚’è¦‹å¤±ã„ã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã€‚", bg:"linear-gradient(135deg,#b34700,#3d1f00)"},
    "fast-emo": {name:"âš¡Fast-Emoï¼ˆç¤¾äº¤ã‚¿ãƒ¼ãƒœå‹ï¼‰", img:"image/fast-emo.png", desc:"ãƒãƒªã®è‰¯ã•ãŒé­…åŠ›ã®ç¬ç™ºå‹ã€‚", bg:"linear-gradient(135deg,#b65b38,#4b2418)"},
    "fast-cool": {name:"â„ï¸Fast-Coolï¼ˆç†æ€§ã‚¹ãƒ—ãƒªãƒ³ãƒˆå‹ï¼‰", img:"image/fast-cool.png", desc:"ä»£è¬ãŒé€Ÿãã‚¯ãƒ¼ãƒ«ãªç†æ€§ã‚¿ã‚¤ãƒ—ã€‚", bg:"linear-gradient(135deg,#455a64,#1c313a)"},
    "slow-cool": {name:"ğŸŒ¿Slow-Coolï¼ˆæ…é‡ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å‹ï¼‰", img:"image/slow-cool.png", desc:"ç©ã‚„ã‹ã§å®‰å®šã—ãŸã‚¿ã‚¤ãƒ—ã€‚", bg:"linear-gradient(135deg,#2e7d32,#0d5302)"}
  };

  document.body.style.background = info[type].bg;
  document.getElementById("typeName").textContent = info[type].name;
  document.getElementById("typeImg").src = info[type].img;
  document.getElementById("typeDesc").textContent = info[type].desc;

  const beer = Math.round(grams/20), chu = Math.round(grams/20), high = Math.round(grams/20), sake = Math.round(grams/22), whisky = Math.round(grams/19);
  document.getElementById("doseResult").innerHTML =
  `æ¨å¥¨ï¼šç´”ã‚¢ãƒ«ã‚³ãƒ¼ãƒ« ${grams}gï¼æ—¥ ç¨‹åº¦<br>
   ğŸºãƒ“ãƒ¼ãƒ«:${beer}æœ¬ ğŸ¹é…ãƒã‚¤:${chu}ç¼¶ ğŸ¥ƒãƒã‚¤ãƒœãƒ¼ãƒ«:${high}æ¯<br>
   ğŸ¶æ—¥æœ¬é…’:${sake}åˆ ğŸŸ¤ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼:${whisky}æ¯`;

  document.getElementById("quiz").style.display="none";
  document.getElementById("result").style.display="block";
  window.lastDose = {grams,type};
}

// ==== åˆè¨ˆã‚¢ãƒ«ã‚³ãƒ¼ãƒ« ====
function calcTotalIntake(){
  let total=0; for(let k in alcoholTable){ total += (parseFloat(document.getElementById(k).value)||0)*alcoholTable[k]; }
  const safe=window.lastDose?.grams||40; const type=window.lastDose?.type||"fast-cool";
  let msg="",color="",advice="";
  if(total<=safe){msg=`ğŸ€ åˆè¨ˆ ${total}gã€‚ç†æƒ³çš„ãªãƒšãƒ¼ã‚¹ã§ã™ã€‚`;color="#2e7d32";advice=type.includes("emo")?"æ°´ã‚’å¤šã‚ã«ã¨ã£ã¦ä½™éŸ»ã‚’æ¥½ã—ã‚‚ã†ã€‚":"è»½ã„é£Ÿäº‹ã¨ä¸€ç·’ã«ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚’ã€‚";}
  else if(total<=safe*1.5){msg=`âš ï¸ ${total}gï¼ˆã‚„ã‚„è¶…éï¼‰ã€‚å°‘ã—ãƒšãƒ¼ã‚¹ã‚’è½ã¨ãã†ã€‚`;color="#f9a825";advice=type.includes("emo")?"é€”ä¸­ã§ãƒãƒ³ã‚¢ãƒ«ã‚’æŒŸã‚‚ã†ï¼":"æ²¹ã‚‚ã®ã‚’æ§ãˆã¦èƒƒã‚’å®ˆã‚ã†ã€‚";}
  else{msg=`ğŸš« ${total}gï¼ˆå±é™ºåŸŸï¼‰ã€‚ä»Šæ—¥ã¯ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’ã€‚`;color="#c62828";advice=type.includes("emo")?"ä¸€åº¦æ·±å‘¼å¸ã—ã¦ãƒšãƒ¼ã‚¹ãƒ€ã‚¦ãƒ³ã€‚":"æ°´åˆ†ã‚’ã—ã£ã‹ã‚Šå–ã£ã¦æ—©ã‚ã®ä¼‘æ¯ã‚’ã€‚";}
  const out=document.getElementById("intakeResult");
  out.style.color=color; out.innerHTML=msg; document.getElementById("advice").textContent=advice;
}

// ==== å†ã‚¹ã‚¿ãƒ¼ãƒˆ ====
function restart(){
  document.body.style.background="linear-gradient(135deg,#0f2027,#203a43,#2c5364)";
  document.getElementById("result").style.display="none";
  document.getElementById("quiz").style.display="block";
  document.querySelectorAll('input[type=radio],input[type=checkbox]').forEach(el=>el.checked=false);
  ['beer','chu','high','sake','whisky'].forEach(id=>document.getElementById(id).value=0);
}

// ==== ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ ====
const modal=document.getElementById("typeModal");
document.getElementById("toggleTypeCards").addEventListener("click",()=>modal.style.display="flex");
document.getElementById("closeTypeCards").addEventListener("click",()=>modal.style.display="none");
window.addEventListener("click",e=>{if(e.target===modal)modal.style.display="none";});

// ==== PWAç™»éŒ² ====
if('serviceWorker' in navigator){
  window.addEventListener('load',()=>{
    navigator.serviceWorker.register('service-worker.js')
      .then(r=>console.log('âœ… ServiceWorkerç™»éŒ²æˆåŠŸ:',r))
      .catch(e=>console.log('âŒ å¤±æ•—:',e));
  });
}
</script>
</body>
</html>
