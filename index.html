<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ALTI飲酒タイプ診断</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#e53935">
<link rel="apple-touch-icon" sizes="192x192" href="./image/icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="./image/icon-512.png">
<link rel="apple-touch-startup-image" href="./image/splash-2048x2732.png">

<style>
:root {--ink:#111; --radius:12px; --shadow:0 2px 6px rgba(0,0,0,0.15);}
body {
  font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans","Noto Sans JP",sans-serif;
  color:var(--ink); background:#fafafa;
  margin:0; padding:20px; max-width:640px; margin:auto;
  transition:background 1s ease-in-out,color 1s ease;
}
h1{text-align:center;font-size:1.7em;margin:10px 0 20px;word-break:keep-all;}
.question{margin:18px 0;}
button{
  display:block;width:100%;padding:12px;margin:15px 0;
  border:none;border-radius:var(--radius);font-size:1em;
  background:#e53935;color:#fff;box-shadow:var(--shadow);cursor:pointer;
}
.result{text-align:center;display:none;}
img{width:100%;max-width:320px;border-radius:10px;}
.desc{margin-top:10px;font-size:0.95em;line-height:1.6;}
.stand-quote {
  color:#fff;text-shadow:0 2px 6px rgba(0,0,0,0.5);
  background:rgba(0,0,0,0.25);padding:8px 10px;
  border-radius:8px;display:inline-block;
}
#intakeInput{margin-top:20px;background:rgba(255,255,255,0.8);padding:12px;border-radius:10px;}
input{margin:4px;}
.drinkRow{margin:6px 0;}
.fade-in{opacity:0;transform:translateY(8px);animation:fadeUp 1.2s ease forwards;}
@keyframes fadeUp{to{opacity:1;transform:translateY(0);}}
.selectBox {margin:10px 0;padding:10px;background:#fff;border-radius:8px;box-shadow:var(--shadow);}
label {display:inline-block;margin-right:10px;}
</style>
</head>
<body>

<h1>ALTI飲酒タイプ診断</h1>

<!-- 🔹診断前設定 -->
<div id="preSetting" class="fade-in">
  <div class="selectBox">
    <h3>今日の体調を選択</h3>
    <label><input type="radio" name="condition" value="good"> 絶好調</label>
    <label><input type="radio" name="condition" value="normal" checked> 普通</label>
    <label><input type="radio" name="condition" value="tired"> 疲労気味</label>
  </div>
  <div class="selectBox">
    <h3>シーンを選択</h3>
    <label><input type="radio" name="scene" value="home"> 家飲み</label>
    <label><input type="radio" name="scene" value="light"> 軽い飲み会</label>
    <label><input type="radio" name="scene" value="party" checked> 飲み会モード</label>
  </div>
  <button onclick="startQuiz()">診断スタート</button>
</div>

<!-- 🔹診断本体 -->
<div id="quiz" style="display:none;">
  <form id="altiForm">
    <div class="question"><p>1. お酒を飲んで10分以内に顔が赤くなることがある。</p>
      <label><input type="radio" name="q1" value="slow"> はい</label>
      <label><input type="radio" name="q1" value="fast"> いいえ</label></div>
    <div class="question"><p>2. ビール1杯でも動悸や息苦しさを感じることがある。</p>
      <label><input type="radio" name="q2" value="slow"> はい</label>
      <label><input type="radio" name="q2" value="fast"> いいえ</label></div>
    <div class="question"><p>3. 少量でも体が熱くなり、手足がほてる。</p>
      <label><input type="radio" name="q3" value="slow"> はい</label>
      <label><input type="radio" name="q3" value="fast"> いいえ</label></div>
    <div class="question"><p>4. 翌朝、頭痛や倦怠感が残ることが多い。</p>
      <label><input type="radio" name="q4" value="slow"> はい</label>
      <label><input type="radio" name="q4" value="fast"> いいえ</label></div>
    <div class="question"><p>5. お酒を飲んだ夜は眠りが浅くなりやすい。</p>
      <label><input type="radio" name="q5" value="slow"> はい</label>
      <label><input type="radio" name="q5" value="fast"> いいえ</label></div>
    <div class="question"><p>6. お酒を飲んだ翌日、集中力が落ちる。</p>
      <label><input type="radio" name="q6" value="slow"> はい</label>
      <label><input type="radio" name="q6" value="fast"> いいえ</label></div>
    <div class="question"><p>7. 周りのテンションに引っ張られやすい。</p>
      <label><input type="radio" name="q7" value="emo"> はい</label>
      <label><input type="radio" name="q7" value="cool"> いいえ</label></div>
    <div class="question"><p>8. 断るよりも「少しだけ飲もう」と思ってしまう。</p>
      <label><input type="radio" name="q8" value="emo"> はい</label>
      <label><input type="radio" name="q8" value="cool"> いいえ</label></div>
    <div class="question"><p>9. 飲み会では静かよりも盛り上がっていたい。</p>
      <label><input type="radio" name="q9" value="emo"> はい</label>
      <label><input type="radio" name="q9" value="cool"> いいえ</label></div>
    <div class="question"><p>10. お酒を飲むと気分が高揚しやすい。</p>
      <label><input type="radio" name="q10" value="emo"> はい</label>
      <label><input type="radio" name="q10" value="cool"> いいえ</label></div>
    <button type="button" onclick="showResult()">診断する</button>
  </form>
</div>

<!-- 🔹診断結果 -->
<div class="result" id="result">
  <h2 id="typeName"></h2>
  <img id="typeImg" src="" alt="診断結果画像">
  <p class="desc" id="typeDesc"></p>
  <p class="stand-quote fade-in" id="standQuote"></p>
  <p id="doseResult" class="desc"></p>

  <div id="intakeInput" class="fade-in">
    <h3>実際に飲んだ杯数を入力</h3>
    <div class="drinkRow">🍺 ビール：<input type="number" id="beer" min="0" step="0.1" value="0"> 本　
    🍹 酎ハイ：<input type="number" id="chu" min="0" step="0.1" value="0"> 缶</div>
    <div class="drinkRow">🥃 ハイボール：<input type="number" id="high" min="0" step="0.1" value="0"> 杯　
    🍶 日本酒：<input type="number" id="sake" min="0" step="0.1" value="0"> 合　
    🟤 ウイスキー：<input type="number" id="whisky" min="0" step="0.1" value="0"> 杯</div>
    <button type="button" onclick="calcTotalIntake()">判定する</button>
    <p id="intakeResult" class="desc"></p>
  </div>

  <p id="notice" class="desc" style="font-size:0.85em;color:#444;margin-top:20px;">
  ※ この診断と推奨値は一般的な目安であり、医学的助言を目的としたものではありません。<br>
  飲酒はあくまで自己責任のもと、無理のない範囲で楽しみましょう。
  </p>

  <button onclick="restart()">もう一度診断する</button>
</div>

<script>
const alcoholTable={beer:20,chu:20,high:20,sake:22,whisky:19};
let modifiers={condition:1.0,scene:1.0};

function startQuiz(){
  const cond=document.querySelector('input[name="condition"]:checked')?.value;
  const scene=document.querySelector('input[name="scene"]:checked')?.value;

  modifiers.condition = cond==="good"?1.1 : cond==="tired"?0.8 : 1.0;
  modifiers.scene = scene==="party"?1.2 : scene==="light"?1.1 : 1.0;

  document.getElementById("preSetting").style.display="none";
  document.getElementById("quiz").style.display="block";
}

function showResult(){
  const answers=document.querySelectorAll('input[type=radio]:checked');
  if(answers.length<10){alert("すべての質問に答えてください");return;}
  let score={slow:0,fast:0,emo:0,cool:0};
  answers.forEach(a=>score[a.value]++);
  const axis1=score.slow>score.fast?"slow":"fast";
  const axis2=score.emo>score.cool?"emo":"cool";
  window.lastMood=axis2;

  let base=axis1==="slow"?15:25;
  let adj=axis2==="emo"?0.85:1.0;
  let grams=Math.round(base*adj*modifiers.condition*modifiers.scene);
  window.lastDose={grams};

  const data={
    "slow-emo":{name:"🔥Slow-Emo（感情ジェット型）",img:"image/slow-emo.png",desc:"感情のスイッチが入りやすいタイプ。",bg:"linear-gradient(135deg,#f57c00,#ffe082)",quote:"『燃える瞬間は美しいが、燃え尽きるなよ。』"},
    "fast-cool":{name:"❄️Fast-Cool（理性スプリント型）",img:"image/fast-cool.png",desc:"代謝が速く冷静さを保つタイプ。",bg:"linear-gradient(135deg,#4a6572,#cfd8dc)",quote:"『氷のように冷静でも、油断はひびを呼ぶ。』"},
    "fast-emo":{name:"⚡Fast-Emo（社交ターボ型）",img:"image/fast-emo.png",desc:"ノリの良さと瞬発力が魅力。",bg:"linear-gradient(135deg,#ffb300,#bbdefb)",quote:"『波は乗るもの、飲まれるものじゃない！』"},
    "slow-cool":{name:"🌿Slow-Cool（慎重ハイブリッド型）",img:"image/slow-cool.png",desc:"穏やかで安定したタイプ。",bg:"linear-gradient(135deg,#81c784,#e8f5e9)",quote:"『風に任せていい。ただし、根は忘れるな。』"}
  };
  const type=axis1+"-"+axis2;
  const info=data[type];

  document.body.style.background=info.bg;
  document.getElementById("typeName").textContent=info.name;
  document.getElementById("typeImg").src=info.img;
  document.getElementById("typeDesc").textContent=info.desc;
  document.getElementById("standQuote").textContent=info.quote;
  document.getElementById("doseResult").innerHTML=`推奨：純アルコール ${grams}g／日 程度`;

  document.getElementById("quiz").style.display="none";
  document.getElementById("result").style.display="block";
}

function calcTotalIntake(){
  let total=0;
  for(let key in alcoholTable){
    total+=alcoholTable[key]*(parseFloat(document.getElementById(key).value)||0);
  }
  const safe=window.lastDose.grams||20;
  const mood=window.lastMood||"cool";
  let msg="",color="";
  if(total<=safe){
    msg=mood==="emo"?`🍀ナイスコントロール！ 全体 ${total.toFixed(1)}g、安全圏！`:`🍀全体 ${total.toFixed(1)}g。理想的です。`;
    color="#2e7d32";
  }else if(total<=safe*1.5){
    msg=mood==="emo"?`⚠️少し熱いね（${total.toFixed(1)}g）。明日は水を多めに。`:`⚠️${total.toFixed(1)}g、少し多め。休肝日を意識！`;
    color="#f9a825";
  }else{
    msg=mood==="emo"?`🚫合計 ${total.toFixed(1)}g！完全にオーバー。身体リミット超。`:`🚫${total.toFixed(1)}g。今日は撤退判断を！`;
    color="#c62828";
  }
  const out=document.getElementById("intakeResult");
  out.style.color=color; out.innerHTML=msg;
}

function restart(){
  document.body.style.background="#fafafa";
  document.getElementById("result").style.display="none";
  document.getElementById("preSetting").style.display="block";
  document.querySelectorAll('input[type=radio]').forEach(el=>el.checked=false);
  ['beer','chu','high','sake','whisky'].forEach(id=>document.getElementById(id).value=0);
}

if("serviceWorker" in navigator){
  navigator.serviceWorker.register("service-worker.js");
}
</script>
</body>
</html>
